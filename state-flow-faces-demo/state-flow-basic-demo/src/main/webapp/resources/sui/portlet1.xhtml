<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:cc="http://java.sun.com/jsf/composite"
      xmlns:x="http://xmlns.apache.org/faces/scxml"
      xmlns:fx="http://xmlns.apache.org/faces/fxscxml"
      xmlns:f="http://xmlns.jcp.org/jsf/core">

    <cc:interface>
        <cc:attribute name="path" required="false"/>
        <cc:attribute name="caption" required="false"/>
    </cc:interface>


    <cc:implementation>

        <x:scxml id="default" initial="step1">
            <x:datamodel>
                <x:data id="path"/>
                <x:data id="caption"/>
            </x:datamodel>

            <x:state id="step1">
                <x:invoke type="facet" src="@this:facet1">
                </x:invoke>
                <x:transition event="error.execution" target="error"/>
                <x:transition event="view.action.next" target="step2"/>
            </x:state>

            <x:state id="step2">
                <x:invoke type="facet" src="@this:facet2">
                </x:invoke>
                <x:transition event="error.execution" target="error"/>
                <x:transition event="view.action.prev" target="step1"/>
            </x:state>

        </x:scxml>    

        <f:facet name="facet1">
            <h:panelGrid columns="1">
                <h:outputLabel value="#{chart.caption}"/>
                <h:panelGroup>
                    <hr/>
                    <p/>
                    <b>Used facet:</b>
                    <p/>facet name = <i>facet1</i>
                    <p/>\#{chart.path} = <i>"#{chart.path}"</i>
                    <hr/>
                </h:panelGroup>
                <b>Test action and invoke elements.</b>
                <h:panelGrid cellspacing="4" columns="6" style="bottom: 0px">
                    <h:commandButton
                        action="portlet-action"
                        value="Custom Portlet Action"
                        immediate="false">
                    </h:commandButton>
                    <h:commandButton
                        action="portlet-ajax-action"
                        value="Ajax Portlet Action"
                        immediate="false">
                        <f:ajax render="@form"/>
                    </h:commandButton>
                    <h:commandButton
                        action="next"
                        value="Go Next"
                        immediate="false">
                    </h:commandButton>
                </h:panelGrid>
            </h:panelGrid>
        </f:facet>

        <f:facet name="facet2">
            <h:panelGrid columns="1">
                <h:outputLabel value="#{chart.caption}"/>
                <h:panelGroup>
                    <hr/>
                    <p/>
                    <b>Used facet:</b>
                    <p/>facet name = <i>facet1</i>
                    <p/>\#{chart.path} = <i>"#{chart.path}"</i>
                    <hr/>
                </h:panelGroup>
                <b>Test action and invoke elements.</b>
                <h:panelGrid cellspacing="4" columns="6" style="bottom: 0px">
                    <h:commandButton
                        action="portlet-action"
                        value="Custom Portlet Action"
                        immediate="false">
                    </h:commandButton>
                    <h:commandButton
                        action="portlet-ajax-action"
                        value="Ajax Portlet Action"
                        immediate="false">
                        <f:ajax render="@form"/>
                    </h:commandButton>
                    <h:commandButton
                        action="prev"
                        value="Go Prev"
                        immediate="false">
                    </h:commandButton>
                </h:panelGrid>
            </h:panelGrid>
        </f:facet>
        
        
        <fx:renderState name="default">
            <f:param name="path" value="#{cc.attrs.path}"/>
            <f:param name="caption" value="#{cc.attrs.caption}"/>
        </fx:renderState>

    </cc:implementation>
</html>
